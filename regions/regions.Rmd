---
title: "CTE Trailblazers: Regional Analysis"
author: "Arthur Small"
date:    Version of `r Sys.Date()`
output:  html_notebook
editor_options: 
  chunk_output_type: inline
---
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r extract table of growing regions for each cluster from full nonduplicated data set, warning = FALSE, message = FALSE, echo=FALSE}
readRDS(here::here("data_prep","nonduplicated-all-regions-and-pathways.Rds")) %>%
  filter(is.na(pathway_code)) %>%
  select(cluster_code, cluster, Region, fraction_change) %>%
  arrange(cluster, desc(fraction_change), Region) -> regional_tbl

regional_tbl %>% 
  group_by(cluster_code) %>%
  filter(fraction_change >= fraction_change[which(Region == "Virginia")]) %>%
  ungroup() %>%
  select(-cluster_code) %>%
  mutate(Projected_Growth_Rate = scales::percent(fraction_change, accuracy = 0.1L)) %>%
  select(Cluster = cluster, Region, Projected_Growth_Rate) -> growing_regions_tbl
```

```{r print table of regional growth rates}
print(growing_regions_tbl)
```

```{r save tibble of regional growth rates, echo=FALSE}
save2file <- here::here("regions", "growing_regions_tbl.Rds")
saveRDS(growing_regions_tbl, save2file)
```

